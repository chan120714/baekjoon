#import<bits/stdc++.h>
#define F(i,n)for(i=0;i<n;i++)
#define O cout<<
#define I cin>>
using l=long long;using namespace std;string A[2],D;struct S{l A,B[27],C,D[27],E[27],F[27],G[27],H[27],L,J;string K;}x[1010];l C(S a,S b){return a.A==b.A?a.C==b.C?a.L==b.L?a.J==b.J?a.K<b.K:a.J<b.J:a.L<b.L:a.C<b.C:a.A>b.A;}l a,b,c,d,e,f,g,h,m[50505],n[27],o,p,q,r,s,u,v,w,y,T,i;map<string,l>Q;l X(l i,l j){return A[i][j]*10+A[i][j+1]-528;}void Y(l x){if(f)O x/60<<(x%60<10?":0":":")<<x%60;else O x;}l Z(){tm d={X(1,6),X(1,3),X(1,0),X(0,8),X(0,5)-1,X(0,0)*100+X(0,2)};return mktime(&d);}main(){I a>>A[0]>>A[1]>>c>>d>>e>>f>>g;b=Z();F(i,g){I h>>q>>w;n[m[h]=--q]=max(1ll,w);}I p;F(i,p){I A[0];Q[x[i].K=A[0]]=i+1;}I o;F(i,o){I q>>r>>D>>s>>h>>u>>A[0]>>A[1];v=Z();if(Q[D]&&s^13&&(s^11|!d)){S&z=x[Q[D]-1];y=m[r];z.J=q;z.E[y]++;if(s<5){z.L=q;u=u?u:e?n[y]:1;if(z.B[y]<u){z.G[y]=(z.E[y]-1)*a;z.H[y]=(v-b)/60;z.D[y]=e&&n[y]-u?2:3;z.F[y]=z.E[y];z.B[y]=u;}}else z.D[y]+=!z.D[y];}}F(i,p){S&z=x[i];z.A=z.C=T=0;F(h,g){T=c?max(T,z.H[h]):T+z.H[h];z.C+=z.G[h];z.A+=z.B[h];}z.C+=T;}sort(x,x+p,C);F(i,p){S&z=x[i];if(z.A^T||z.C^y)w=i+1,T=z.A,y=z.C;O w<<','<<z.K;F(h,g){l r=z.D[h];O ','<<"0wpa"[r]<<'/';if(r>1){if(e)O z.B[h]<<'/';O z.F[h]<<'/';Y(z.H[h]+z.G[h]*!c);}else{if(r)O z.E[h]<<'/';O "--";}}O ','<<z.A<<'/';Y(z.C);O '\n';}}